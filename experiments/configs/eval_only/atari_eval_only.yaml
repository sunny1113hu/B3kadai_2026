# Atari: 保存済みモデルの評価専用
# 学習は行わず、保存済みモデルの性能を評価します

experiment_name: atari_eval_only
python: .venv/bin/python
results_dir: experiments/outputs
seeds:
  - 0

runs:
  # =========================
  # Enduro
  # =========================
  - id: dqn_enduro_eval
    type: atari_dqn
    env: EnduroNoFrameskip-v4
    env_index: 20

    max_train_steps: 1000000
    eval_interval: 2500
    eval_turns: 1
    save_interval: 0

    # 学習時と同じ構成（ロード互換のため）
    gamma: 0.99
    batch_size: 64
    double: false
    duel: false
    noisy: false

    load_model: true
    eval_only: true
    model_index: 1000           # steps/1000（例: 1,000,000 steps -> 1000）

    write: true
    device: cuda
    record_video: true
    video_episodes: 1

  - id: per_enduro_eval
    type: atari_dqn
    env: EnduroNoFrameskip-v4
    env_index: 20

    max_train_steps: 1000000
    eval_interval: 2500
    eval_turns: 1
    save_interval: 0

    gamma: 0.99
    batch_size: 64
    double: false
    duel: false
    noisy: false
    PER: true

    load_model: true
    eval_only: true
    model_index: 1000

    write: true
    device: cuda
    record_video: true
    video_episodes: 1

  # =========================
  # Freeway
  # =========================
  - id: dqn_freeway_eval
    type: atari_dqn
    env: FreewayNoFrameskip-v4
    env_index: 22

    max_train_steps: 1000000
    eval_interval: 2500
    eval_turns: 1
    save_interval: 0

    gamma: 0.99
    batch_size: 64
    double: false
    duel: false
    noisy: false

    load_model: true
    eval_only: true
    model_index: 1000

    write: true
    device: cuda
    record_video: true
    video_episodes: 1

  - id: per_freeway_eval
    type: atari_dqn
    env: FreewayNoFrameskip-v4
    env_index: 22

    max_train_steps: 1000000
    eval_interval: 2500
    eval_turns: 1
    save_interval: 0

    gamma: 0.99
    batch_size: 64
    double: false
    duel: false
    noisy: false
    PER: true

    load_model: true
    eval_only: true
    model_index: 1000

    write: true
    device: cuda
    record_video: true
    video_episodes: 1

  # =========================
  # Kung Fu Master
  # =========================
  - id: dqn_kungfumaster_eval
    type: atari_dqn
    env: KungFuMasterNoFrameskip-v4
    env_index: 31

    max_train_steps: 1000000
    eval_interval: 2500
    eval_turns: 1
    save_interval: 0

    gamma: 0.99
    batch_size: 64
    double: false
    duel: false
    noisy: false

    load_model: true
    eval_only: true
    model_index: 1000

    write: true
    device: cuda
    record_video: true
    video_episodes: 1

  - id: per_kungfumaster_eval
    type: atari_dqn
    env: KungFuMasterNoFrameskip-v4
    env_index: 31

    max_train_steps: 1000000
    eval_interval: 2500
    eval_turns: 1
    save_interval: 0

    gamma: 0.99
    batch_size: 64
    double: false
    duel: false
    noisy: false
    PER: true

    load_model: true
    eval_only: true
    model_index: 1000

    write: true
    device: cuda
    record_video: true
    video_episodes: 1
